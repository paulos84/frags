{% extends "base_bioactive_generic.html" %}
{% load bootstrap3 %}
{% load static %}

{% block title %}
    <title>{{ bioactive }}</title>
{% endblock %}

{% block head %}
     <link rel="stylesheet" href="{% static 'css/bioactive.css' %}">
     <script src="http://3Dmol.csb.pitt.edu/build/3Dmol-min.js"></script>
{% endblock %}


{% block content %}
<div class="col-sm-6 " style="position: relative; left:20px; ">
    {% if bioactive.chemical_name %}
        <h4 class="intro">{{ bioactive }}</h4>
        <h5 class="intro">{{ bioactive.iupac_name }}</h5>
    {% else %}
        <h5 class="intro">{{ bioactive.iupac_name }}</h5>
    {% endif %}
    <p><strong>SMILES:</strong> {{ bioactive.smiles }}</p>
    <p><strong>InChIKey:</strong> {{ bioactive.inchikey }}</p>

    <div class="btn-group" role="group" style="margin-top:4px; ">
        <a href="{% url 'literature-references' pk=bioactive.pk compound_type='bioactive' %}">
            <button style="width: 170px; background-color: #f6f6f6; " type="button" class="btn btn-secondary">Literature references</button></a>
        {% if user.is_authenticated %}
           <a href="{% url 'user-compound-sources'  pk=bioactive.pk compound_type='bioactive' %}">
               <button type="button" style=" background-color: #f6f6f6; " class="btn btn-secondary" >
               <span class="glyphicon glyphicon"></span>Saved sources</button>
           </a>
        {% else %}
            <button style="width: 170px" type="button" class="btn btn-secondary" disabled>
                <span class="glyphicon glyphicon"></span>Saved sources</button>
        {% endif %}
    </div>

    <div class="btn-group" role="group" style="margin-top:14px; ">
        <button type="button" class="btn btn-secondary" style="color: #6aaf6a; width:160px; "
                onclick="$('#chem_properties_table').toggle();
                $('#substructure_matches').hide();
                $('#commercial_sources').hide();
                $('#3dmol-viewer').hide() ">
            Chemical properties</button>
        <button type="button" class="btn btn-secondary" style="color: #6aaf6a; width:130px; "
                onclick="$('#substructure_matches').toggle();
                $('#chem_properties_table').hide();
                $('#commercial_sources').hide();
                $('#3dmol-viewer').hide() ">
            Substructures</button>
        <button type="button" class="btn btn-secondary" style="color: #6aaf6a; width:160px; "
                onclick="$('#commercial_sources').toggle();
                 $('#chem_properties_table').hide();
                 $('#substructure_matches').hide();
                 $('#3dmol-viewer').hide() ">
            Commercial sources</button>
        <button type="button" class="btn btn-secondary" style="color: #6aaf6a; width:110px; "
                onclick="$('#3dmol-viewer').toggle();
                 $('#chem_properties_table').hide();
                 $('#substructure_matches').hide();
                 $('#commercial_sources').hide() ">
            3D Molecule</button>
    </div>
        <div id="commercial_sources" style="display: none">
            <p>I am com sources</p>
        </div>
        <div id="chem_properties_table" style="display: none">
            <table class="table" style="width: 290px">
            {% for key, value in chemical_properties.items|dictsort:"0.lower" %}
                <tr>
                    <td width="220"><strong>{{ key }}</strong>: </td><td> {{ value }}</td>
                </tr>
            {% endfor %}
            </table>
        </div>
        <div id="substructure_matches" style="display: none; margin-top: 44px;  ">
        {% if substructures %}
            {% for substruct in substructures %}
                <div class="structure-img"><a href="{{ substruct.get_absolute_url }}">
                    <img src={{ substruct.structure_url }} height="150" width="150" title={{ substruct }} >
                    <div style="position: relative; left:30px; margin-top:7px; ">
                                <a href="{{ substruct.get_absolute_url }}">{{ substruct }}</a></div>
            </a></div>
            {% endfor %}
        {% endif %}
        </div>
        <div style="height: 300px; width: 300px; position: relative; left: 30px; " id="3dmol-viewer"
             class='viewer_3Dmoljs' data-cid={{ cid_string }} data-backgroundcolor='0xffffff' data-style='stick'>
        </div>
</div>

<div class="col-sm-4 ">
    <div style="float:left; position:relative; top:2px" class="structure-img">
        <img width="220" height="220" class="structure-img" src={{ bioactive.structure_url }} title={{substructure}} >
    </div>
    <div style=" position:relative; top:24px; width:280px; left:12px">
        <p><strong>Synonyms:</strong> {{ bioactive.synonyms|truncatechars:124 }}</p>
    </div>
    {% if bioactive.activity %}
    <div style=" position:relative; top:24px; width:280px; left:12px">
        <p><strong>Classification:</strong> {{ bioactive.activity.get_classification_display }}</p>
    </div>
    {% endif %}
    {% if bioactive.action %}
    <div style=" position:relative; top:24px; width:280px; left:12px">
        <p><strong>Action:</strong> {{ bioactive.action }}</p>
    </div>
    {% endif %}
    {% if bioactive.mechanism %}
    <div style=" position:relative; top:24px; width:280px; left:12px">
        <p><strong>Mechanism:</strong> {{ bioactive.mechanism }}</p>
    </div>
    {% endif %}
</div>

<div class="col-sm-10 " style="margin-top:10px">

</div>
{% endblock %}

